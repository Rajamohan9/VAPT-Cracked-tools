name: ðŸŽ‰ Release new version

on:
  workflow_call:
    inputs:
      version:
        description: 'Version to release'
        required: true
        type: string

permissions:
  # Give the default GITHUB_TOKEN write permission to commit and push the
  # added or changed files to the repository.
  contents: write

jobs:
  release:
    name: Release new version
    runs-on: ubuntu-latest
    steps:
      - name: Check out repo
        uses: actions/checkout@v3

      - name: Set Environment Variables
        uses: tw3lveparsecs/github-actions-setvars@latest
        with:
          envFilePath: .github/variables/global.env

      - name: Download Latest Keygen/Loader
        uses: robinraju/release-downloader@v1.7
        with:
          repository: "h3110w0r1d-y/BurpLoaderKeygen"
          latest: true
          fileName: BurpLoaderKeygen.jar

      - run: |
          ls -la
          echo "Version: ${{ inputs.version }}"
  
  build_windows:
    # Creates a new release if there were changes detected in the previous job.
    # It will also upload the Burp Suite JAR file to the release.
    name: Build Windows
    secrets: inherit
    with:
      version: ${{ inputs.version }}
    uses: mmgordon82/BurpSuiteInstaller/.github/workflows/release-windows.yml@main